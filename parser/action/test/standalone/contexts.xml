<?xml version="1.0" encoding="utf-8"?>
<tst:tests xmlns:tst="http://www.sylma.org/parser/action/test/standalone" xmlns="http://www.sylma.org" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:le="http://www.sylma.org/parser/action" xmlns:li="http://www.sylma.org/parser/caller" xmlns:lm="http://www.sylma.org/parser/action/basic">
  <tst:description>Contexts</tst:description>
  <tst:test name="one context">
    <tst:prepare>
      $action = $controler->getAction('samples/context01');
      $action->setContexts($controler->createArgument(array('css' => new \sylma\modules\html\context\Basic)));

      $controler->setArgument('action', $action);
    </tst:prepare>
    <tst:node>
      <div xmlns="http://www.sylma.org">world</div>
    </tst:node>
    <tst:expected>
      $action = $controler->getArgument('action');
      $node = $controler->getArgument('node');

      return
        $controler->compareNodes($action->asDOM(), $node) &amp;&amp;
        $action->getContext('css')->asArray() === array('hello');
    </tst:expected>
  </tst:test>
  <tst:test name="two contexts">
    <tst:prepare>
      $action = $controler->getAction('samples/context02');
      $action->setContexts($controler->createArgument(array('css' =>  new \sylma\modules\html\context\Basic, 'js' => new \sylma\modules\html\context\Basic)));

      $controler->setArgument('action', $action);
    </tst:prepare>
    <tst:node>
      <div xmlns="http://www.sylma.org">world</div>
    </tst:node>
    <tst:expected>
      $action = $controler->getArgument('action');
      $node = $controler->getArgument('node');
//echo \Sylma::show($action->getContext('css')->asArray());
//echo \Sylma::show($action->getContext('js')->asArray());
      return
        $controler->compareNodes($action->asDOM(), $node) &amp;&amp;
        $action->getContext('css')->asArray() === array('hello') &amp;&amp;
        $action->getContext('js')->asArray() === array('bonsoir');
    </tst:expected>
  </tst:test>
  <tst:test name="using short call" disabled="true">
    <tst:prepare>
      $action = $controler->getAction('samples/context03');
      $action->setContexts($controler->createArgument(array('css' =>  new \sylma\modules\html\context\Basic)));

      $controler->setArgument('action', $action);
    </tst:prepare>
    <tst:node>
      <div xmlns="http://www.sylma.org">world</div>
    </tst:node>
    <tst:expected>
      $action = $controler->getArgument('action');
      $node = $controler->getArgument('node');

\Sylma::dsp($action->getContext('css')->asArray());

      return
        $controler->compareNodes($action->asDOM(), $node) &amp;&amp;
        $action->getContext('css')->asArray() === array($controler->getDirectory() . '/samples/read.txt');
    </tst:expected>
  </tst:test>
</tst:tests>